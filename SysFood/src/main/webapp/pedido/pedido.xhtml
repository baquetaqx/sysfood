<!DOCTYPE html>
<ui:composition template="/WEB-INF/templates/layoutPrincipal.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="title">SysFood - Dados da empresa</ui:define>
	<ui:define name="page-header">
		<h1 class="page-header">Realize o pedido</h1>
	</ui:define>
	<ui:define name="conteudo">
		<div class="row">
			<h:form id="formPedido">
				<div class="col-lg-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title">
								<i class="fa fa-reorder"></i> Produtos
							</h3>
						</div>
						<div class="panel-body">
							<p:messages />
							<h:panelGrid columns="2" style="width:100%">
							Nome do Cliente:
							<h:panelGroup>
									<p:inputText styleClass="form-control"
										value="#{cadastroPedidoBean.nomeCliente}"
										style="display:inline-table;width:70%; margin-right:5px" />
									<p:commandButton icon="fa fa-plus"
										action="#{cadastroPedidoBean.adicionarCliente}"
										update=":formPedido:nomeCliente" />
								</h:panelGroup>
								<h:panelGroup>
									<br />
								Nome do Produto:
								</h:panelGroup>

								<h:panelGroup>
									<br />
									<p:inputText styleClass="form-control"
										value="#{cadastroPedidoBean.produtoFilter.nome}"
										style="display:inline-table;width:70%; margin-right:5px" />
									<p:commandButton icon="fa fa-search"
										update=":formPedido:tabelaProduto"
										action="#{cadastroPedidoBean.pesquisarProduto}" />
								</h:panelGroup>
							</h:panelGrid>
							<br />
							<p:dataTable paginator="true" rows="10"
								paginatorPosition="bottom" id="tabelaProduto"
								paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
								rowsPerPageTemplate="5,10,15"
								value="#{cadastroPedidoBean.produtosFiltrados}" var="produto"
								emptyMessage="Nenhum produto encontrado">
								<p:column headerText="Nome do produto">
									<h:outputLabel value="#{produto.nome}" />
								</p:column>
								<p:column headerText="Valor UnitÃ¡rio" width="120">
									<h:outputLabel value="#{produto.preco}" />
								</p:column>
								<p:column headerText="Qtd" width="50">
									<h:outputLabel value="#{produto.quantidade}" />
								</p:column>
								<p:column headerText="Add" width="50">
									<p:commandButton icon="fa fa-plus"
										action="#{cadastroPedidoBean.adicionarItem}"
										update=":formPedido:tabelaItens">
										<f:setPropertyActionListener
											target="#{cadastroPedidoBean.produto}" value="#{produto}" />
									</p:commandButton>
								</p:column>

							</p:dataTable>
						</div>
					</div>
				</div>
				<div class="col-lg-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h3 class="panel-title">
								<i class="fa fa-sort-amount-asc"></i> Cupom Fiscal
							</h3>
						</div>
						<div class="panel-body">
							<p:messages />
							<p:outputLabel value="Nome do Cliente: " />
							<p:outputLabel value="#{cadastroPedidoBean.pedido.cliente}"
								id="nomeCliente" />
							<p:dataTable value="#{cadastroPedidoBean.pedido.itens}"
								var="item" id="tabelaItens"
								paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
								emptyMessage="Nenhum produto selecionado">
								<p:column headerText="Nome do produto" width="200">
									<p:outputLabel value="#{item.produto.nome}" styleClass="text-money"/>
								</p:column>
								<p:column headerText="Qtd" width="50">
									<p:inputText value="#{item.quantidade}"
										styleClass="form-control" maxlength="2">
										<p:ajax event="change" process="@this"
											update=":formPedido:tabelaItens" />
									</p:inputText>
								</p:column>
								<p:column headerText="Preco" width="80">
									<p:outputLabel value="#{item.produto.preco}" styleClass="text-money">
										<f:convertNumber type="currency" locale="pt-BR" />
									</p:outputLabel>
								</p:column>
								<p:column headerText="Pco Total" width="90">
									<p:outputLabel value="#{item.valorTotal}" id="pcoTotal" styleClass="text-money">
										<f:convertNumber type="currency" locale="pt-BR" />
									</p:outputLabel>
								</p:column>
								<p:column headerText="Rmv" width="50" style="text-align: center">
									<p:commandLink styleClass="fa fa-remove"
										update=":formPedido:tabelaItens">
										<f:setPropertyActionListener
											target="#{cadastroPedidoBean.produto}" value="#{produto}" />
									</p:commandLink>
								</p:column>
							</p:dataTable>


							<hr class="zig" />
							<hr class="zag" />
							<h:panelGrid style="width:100%">
								<p:outputLabel value="Valor Total R$:" style="float:right" />
							</h:panelGrid>

						</div>
						<br />
						<div class="centralizar">
							<p:commandButton value="Finalizar Pedido"
								styleClass="btn btn-success btn-lg btn-salvar" />
							<p:button value="Novo Pedido"
								styleClass="btn btn-danger btn-lg btn-salvar"
								outcome="/pedido/pedido.xhtml" />
						</div>
					</div>
				</div>
			</h:form>
		</div>
		<!-- /.row -->
	</ui:define>
</ui:composition>